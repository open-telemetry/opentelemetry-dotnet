# OpenTelemetry .NET Diagnostic: OTEL1004

## Overview

This is an experimental API for modifying spans before they end/close

### Details

#### ExtendedBaseProcessor

The abstract class `ExtendedBaseProcessor` provides an extension of the
`BaseProcessor` that allows spans to be modified before they end as per the
OpenTelemetry specification. It provides the `OnEnding` function that is called
during the span `End()` operation. The end timestamp MUST have been computed
(the `OnEnding` method duration is not included in the span duration). The Span
object MUST still be mutable (i.e., `SetAttribute`, `AddLink`, `AddEvent` can be
called) while `OnEnding` is called. This method MUST be called synchronously
within the [`Span.End()` API](api.md#end), therefore it should not block or
throw an exception. If multiple `SpanProcessors` are registered, their
`OnEnding` callbacks are invoked in the order they have been registered. The
SDK MUST guarantee that the span can no longer be modified by any other thread
before invoking `OnEnding` of the first `SpanProcessor`. From that point on,
modifications are only allowed synchronously from within the invoked `OnEnding`
callbacks. All registered SpanProcessor `OnEnding` callbacks are executed before
any SpanProcessor's `OnEnd` callback is invoked.

**Parameters:**

* `span` - a read/write span object for the span which is about to be ended.

**Returns:** `Void`
